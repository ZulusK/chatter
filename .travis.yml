language: node_js
node_js:
- node
sudo: false
before_script:
- mongo mydb_test --eval 'db.createUser({user:"chatter_app",pwd:"chatter",roles:["readWrite"]});'
script:
- npm run lint
services:
- mongodb
- docker
cache:
  directories:
  - node_modules
deploy:
  provider: script
  on:
    branch: master
  script: echo "$DOCKER_PASSWORD" | docker login -u "$DOCKER_USERNAME" --password-stdin && \
            docker build -t registry.heroku.com/chatter/web . && \
            docker push registry.heroku.com/chatter/web

env:
  secure: m9uFLKX/Sp/msqHKkGZBW83cigWLgGFi6L9zc3VbtihNiVngGVHHjRXWCbozhNOEryC3dJcEacU7TDO9qXGB76WOYoLj+QdxL7RONM8pHPTtuHBncspfcpoeD8eiygsS6yS36OV+bXYOm8PbbGIOhEsU0IjqVCldzQr3rid+PxXw4vfMHidR4r7txPZI5s7L6tJ8c5Tn3uXIbIm9ftKVrfLNzTXAPtnHBmeKOgrmjZyqDl6NIztuF9G+mBT+WWujiLO5r/4dFKkWLULzTbX73hIk/ZwJCXO6lmYMGgtHPySDBcQ0HBSfyg0s/Frnc5bgRqh4FIuziecbypZofcp3XCnWXGtW5AprPxUyPaju/vTzWuX7Mz17VG4mXISWg4t5tfQ/MPVUzfMWkdECu3lV4EPZAIM1Ri5Mmfh5VU9a75VuNVOHZTCU3y4RNApntnX9vG8Fk2bXQanKOujuGgmjeVY+N+kat5O2WTNykVcLfzgW+u/HwH3jIojuhR76bOd30xPSW9xqnHLbbiDsNu4c+lDcPH23Jm0v21md69i+6rzuvFA4xhz+B04M7JF3hIlDOIZTXuXIdJDF4SnPgKys3BGcdyHS9SnZt74ukLdCM4RwcecUdA2Pcp3UpOm6ScH7m1rsIaIpiyhBUz8QQwCxpGoqzGyUxgHE6bWHdVxD21g=
